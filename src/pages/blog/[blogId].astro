---
import Layout from "../../layouts/Layout.astro";
import Image from "astro/components/Image.astro";

// 記事の詳細画面へのパスを生成
import { getBlogs, getBlogDetail } from "../../lib/microcms";
export const getStaticPaths = async () => {
  const response = await getBlogs({ fields: ["id"] });
  return response.contents.map((content: any) => ({
    params: {
      blogId: content.id,
    },
  }));
};

const { blogId } = Astro.params;
const blog = await getBlogDetail(blogId as string);
---

<Layout title=`Yuri's Blog | ${blog.title}` activeMenu="Blog">
  <main class="mt-20 pt-5 w-4/5 mx-auto">
    <article>
      <Image
        class="mx-auto"
        src={blog.eyecatch.url}
        alt={blog.eyecatch_alt}
        width="250"
        height="250"
      />

      <h1 class="mt-8 text-2xl font-bold dark:text-slate-50 sm:text-3xl">
        {blog.title}
      </h1>

      <div class="my-2 flex flex-col sm:flex-row">
        <p
          class="text-sm text-gray-600 dark:text-slate-50 sm:text-base sm:mr-10"
        >
          公開日：{
            new Date(blog.publishedAt).toLocaleDateString("ja-JP", {
              year: "numeric",
              month: "short",
              day: "numeric",
            })
          }
        </p>
        <p class="text-sm text-gray-600 dark:text-slate-50 sm:text-base">
          最終更新日：{
            new Date(blog.publishedAt).toLocaleDateString("ja-JP", {
              year: "numeric",
              month: "short",
              day: "numeric",
            })
          }
        </p>
      </div>

      {
        blog.tags.length > 0 &&
          blog.tags.map(tag => (
            <span class="px-2 py-1 mr-1 text-xs font-semibold rounded-2xl border dark:text-slate-50 dark:border-zinc-700">
              {tag.name}
            </span>
          ))
      }

      <div set:html={blog.content} class="mt-14 dark:text-slate-50" />
    </article>
  </main>
</Layout>
